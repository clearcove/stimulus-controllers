import t from"jquery";import{Controller as e}from"stimulus";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var r=function(e){function r(){return e.apply(this,arguments)||this}return n(r,e),r.prototype.connect=function(){t(this.element).popover({delay:{show:300,hide:0}})},r}(e),o=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var r=e.prototype;return r.connect=function(){this.element.setAttribute("style","overflow-y: hidden;"),this.element.addEventListener("input",this.onInputHandler,!1),this.element.dispatchEvent(new Event("input"))},r.onInputHandler=function(){this.style.height="auto",this.style.height=Math.max(this.scrollHeight,60)+"px"},e}(e),s=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var r=e.prototype;return r.connect=function(){this.wrapperClass="nested-attrs-field"},r.add=function(t){t.preventDefault();var e=this.templateTarget.innerHTML.replace(/NEW_RECORD/g,(new Date).getTime());this.linksTarget.insertAdjacentHTML("beforebegin",e)},r.remove=function(t){t.preventDefault();var e=t.target.closest(".nested-attrs-field");"true"===e.dataset.newRecord?e.remove():(e.querySelector("input[name*='_destroy']").value=1,e.style.display="none")},e}(e);s.targets=["links","template"];var i=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var r=e.prototype;return r.add=function(t){t.preventDefault();var e=$(this.typeSelectTarget).select2("data").find(function(t){return t.id.length>0}).id,n=this.templatesTarget.querySelector('[data-nested-typed-attribute-type="'+e+'"]').innerHTML.replace(/NEW_RECORD/g,(new Date).getTime());this.fieldsTarget.insertAdjacentHTML("beforeend",n)},r.remove=function(t){t.preventDefault(),t.target.closest(".nested-typed-attr-field").remove()},e}(e);i.targets=["fields","templates","typeSelect"];var a=function(e){function r(){return e.apply(this,arguments)||this}n(r,e);var o=r.prototype;return o.connect=function(){var t=this;this.select2mount(),document.addEventListener("turbolinks:before-cache",function(){t.select2unmount()},{once:!0})},o.select2mount=function(){t(this.element).select2({minimumResultsForSearch:10,theme:"bootstrap4",width:"100%"})},o.select2unmount=function(){this.saveState(),t(this.element).select2("destroy")},o.saveState=function(){var e=this;t(this.element).select2("data").filter(function(t){return t.id.length>0}).forEach(function(n){t(e.element).find("option[value='"+n.id+"']").attr("selected","selected")})},r}(e),l=function(t){t.register("bootstrap--popover",r),t.register("forms--auto-expand-text-area",o),t.register("forms--nested-attrs",s),t.register("forms--nested-typed-attrs",i),t.register("forms--select2",a)};export{r as BootstrapPopoverController,o as FormsAutoExpandTextareaController,s as FormsNestedAttrsController,i as FormsNestedTypedAttrsController,a as FormsSelect2Controller,l as registerAllControllers};
//# sourceMappingURL=stimulus-controllers.esm.js.map
