{"version":3,"file":"stimulus-controllers.esm.js","sources":["../src/bootstrap/popover_controller.js","../src/forms/auto_expand_textarea_controller.js","../src/forms/nested_attrs_controller.js","../src/forms/nested_typed_attrs_controller.js","../src/forms/select2_controller.js","../src/index.js"],"sourcesContent":["/**\n * Activates Bootstrap popovers.\n *\n * Use like so:\n *\n * See helpers/display_helper#display_info_popover\n *\n */\nimport $ from 'jquery';\nimport { Controller } from 'stimulus';\n\nexport default class extends Controller {\n  connect() {\n    $(this.element).popover({ delay: { show: 300, hide: 0 } });\n  }\n}\n","import { Controller } from 'stimulus';\n\nexport default class extends Controller {\n  connect() {\n    // Adjust textarea's height automatically depending on contents.\n    this.element.setAttribute('style', 'overflow-y: hidden;');\n    this.element.addEventListener('input', this.onInputHandler, false);\n    this.element.dispatchEvent(new Event('input'));\n  }\n\n  onInputHandler() {\n    // Adjust textarea height on input\n    // Setting height to auto makes it shrink instantly if all text is removed.\n    this.style.height = 'auto';\n    // Set min height to 60px (the default auto height in chrome)\n    this.style.height = `${Math.max(this.scrollHeight, 60)}px`;\n  }\n}\n","// Use like so:\n//\n//  %h4 Tasks\n//  %div(data-controller=\"forms--nested-attrs\")\n//    %template(data-target=\"forms--nested-attrs.template\")\n//      = f.fields_for :tasks, Task.new, child_index: 'NEW_RECORD' do |task_f|\n//        = render \"task_fields\", f: task_f\n//\n//    = f.fields_for :tasks do |task_f|\n//      = render \"task_fields\", f: task_f\n//\n//    %div(data-target=\"forms--nested-attrs.links\")\n//      = link_to(\"Add Task\", \"#\", class: \"btn\", data: { action: \"click->forms--nested-attrs#add\" })\n//\n//  # _task_fields.html.erb\n//  %div.nested-attrs-field(data: { new_record: f.object.new_record? })\n//    .form-group\n//      = f.label :description\n//      = f.text_field :description, class: 'form-control'\n//      %small= link_to(\"Remove\", \"#\", data: { action: \"click->forms--nested-attrs#remove\" })\n//\n//    = form.hidden_field :_destroy\n\n/* eslint class-methods-use-this: \"off\" */\nimport { Controller } from 'stimulus';\n\nexport default class extends Controller {\n  static targets = ['links', 'template']\n\n  connect() {\n    this.wrapperClass = 'nested-attrs-field';\n  }\n\n  add(event) {\n    event.preventDefault();\n\n    const content = this.templateTarget.innerHTML.replace(/NEW_RECORD/g, new Date().getTime());\n    this.linksTarget.insertAdjacentHTML('beforebegin', content);\n  }\n\n  remove(event) {\n    event.preventDefault();\n\n    const wrapper = event.target.closest('.nested-attrs-field');\n    if (wrapper.dataset.newRecord === 'true') {\n      // New records are simply removed from the page\n      wrapper.remove();\n    } else {\n      // Existing records are hidden and flagged for deletion\n      wrapper.querySelector(\"input[name*='_destroy']\").value = 1;\n      wrapper.style.display = 'none';\n    }\n  }\n}\n","// Use like so:\n//\n\n/* eslint class-methods-use-this: \"off\" */\nimport $ from 'jquery';\nimport { Controller } from 'stimulus';\n\nexport default class extends Controller {\n  static targets = ['fields', 'templates', 'typeSelect'];\n\n  add(event) {\n    event.preventDefault();\n\n    const attrType = $(this.typeSelectTarget)\n      .select2('data')\n      .find((selectedOption) => selectedOption.id.length > 0).id;\n    const template = this.templatesTarget.querySelector(`[data-nested-typed-attribute-type=\"${attrType}\"]`);\n    const content = template.innerHTML.replace(/NEW_RECORD/g, new Date().getTime());\n    this.fieldsTarget.insertAdjacentHTML('beforeend', content);\n  }\n\n  remove(event) {\n    event.preventDefault();\n\n    const wrapper = event.target.closest('.nested-typed-attr-field');\n    wrapper.remove();\n  }\n}\n","/* Activates Select2 inputs\n *\n * Use like so:\n *\n * <select data-controller=\"forms--select2\">...\n *\n */\nimport $ from 'jquery';\nimport { Controller } from 'stimulus';\n\nexport default class extends Controller {\n  connect() {\n    this.select2mount();\n    document.addEventListener('turbolinks:before-cache', () => {\n      this.select2unmount();\n    }, { once: true });\n  }\n\n  select2mount() {\n    // Bug in select2 prevents us from using placeholder option: https://github.com/select2/select2/issues/3278\n    // const placeholder = $(this.element).data('placeholder')\n    // width: 'resolve', // select2 width bug (see above: placeholder)\n    $(this.element).select2({\n      minimumResultsForSearch: 10,\n      theme: 'bootstrap4',\n      width: '100%'\n    });\n  }\n\n  select2unmount() {\n    this.saveState();\n    $(this.element).select2('destroy');\n  }\n\n  saveState() {\n    const selectedOptions = $(this.element)\n      .select2('data')\n      .filter((selectedOption) => selectedOption.id.length > 0);\n\n    // make sure the HTML itself has those elements selected, since the HTML is what is saved in the\n    // turbolinks snapshot\n    selectedOptions.forEach((selectedOption) => {\n      $(this.element)\n        .find(`option[value='${selectedOption.id}']`)\n        .attr('selected', 'selected');\n    });\n  }\n}\n","import BootstrapPopoverController from './bootstrap/popover_controller';\nimport FormsAutoExpandTextareaController from './forms/auto_expand_textarea_controller';\nimport FormsNestedAttrsController from './forms/nested_attrs_controller';\nimport FormsNestedTypedAttrsController from './forms/nested_typed_attrs_controller';\nimport FormsSelect2Controller from './forms/select2_controller';\n\n// Convenience method to register all included controllers\n// @param application [Stimulus.start] the application object to register controllers with.\nconst registerAllControllers = (application) => {\n  application.register('bootstrap--popover', BootstrapPopoverController);\n  application.register('forms--auto-expand-text-area', FormsAutoExpandTextareaController);\n  application.register('forms--nested-attrs', FormsNestedAttrsController);\n  application.register('forms--nested-typed-attrs', FormsNestedTypedAttrsController);\n  application.register('forms--select2', FormsSelect2Controller);\n};\n\nexport {\n  registerAllControllers,\n  BootstrapPopoverController,\n  FormsAutoExpandTextareaController,\n  FormsNestedAttrsController,\n  FormsNestedTypedAttrsController,\n  FormsSelect2Controller\n};\n"],"names":["connect","$","this","element","popover","delay","show","hide","Controller","setAttribute","addEventListener","onInputHandler","dispatchEvent","Event","style","height","Math","max","scrollHeight","wrapperClass","add","event","preventDefault","content","templateTarget","innerHTML","replace","Date","getTime","linksTarget","insertAdjacentHTML","remove","wrapper","target","closest","dataset","newRecord","querySelector","value","display","targets","attrType","typeSelectTarget","select2","find","selectedOption","id","length","templatesTarget","fieldsTarget","select2mount","document","_this","select2unmount","once","minimumResultsForSearch","theme","width","saveState","filter","forEach","_this2","attr","registerAllControllers","application","register","BootstrapPopoverController","FormsAutoExpandTextareaController","FormsNestedAttrsController","FormsNestedTypedAttrsController","FormsSelect2Controller"],"mappings":"+SAYEA,QAAA,WACEC,EAAEC,KAAKC,SAASC,QAAQ,CAAEC,MAAO,CAAEC,KAAM,IAAKC,KAAM,SAF3BC,qGCR3BR,QAAA,WAEEE,KAAKC,QAAQM,aAAa,QAAS,uBACnCP,KAAKC,QAAQO,iBAAiB,QAASR,KAAKS,gBAAgB,GAC5DT,KAAKC,QAAQS,cAAc,IAAIC,MAAM,aAGvCF,eAAA,WAGET,KAAKY,MAAMC,OAAS,OAEpBb,KAAKY,MAAMC,OAAYC,KAAKC,IAAIf,KAAKgB,aAAc,aAb1BV,qGC2B3BR,QAAA,WACEE,KAAKiB,aAAe,wBAGtBC,IAAA,SAAIC,GACFA,EAAMC,iBAEN,IAAMC,EAAUrB,KAAKsB,eAAeC,UAAUC,QAAQ,eAAe,IAAIC,MAAOC,WAChF1B,KAAK2B,YAAYC,mBAAmB,cAAeP,MAGrDQ,OAAA,SAAOV,GACLA,EAAMC,iBAEN,IAAMU,EAAUX,EAAMY,OAAOC,QAAQ,uBACH,SAA9BF,EAAQG,QAAQC,UAElBJ,EAAQD,UAGRC,EAAQK,cAAc,2BAA2BC,MAAQ,EACzDN,EAAQlB,MAAMyB,QAAU,YAxBD/B,KACpBgC,QAAU,CAAC,QAAS,kHCjB3BpB,IAAA,SAAIC,GACFA,EAAMC,iBAEN,IAAMmB,EAAWxC,EAAEC,KAAKwC,kBACrBC,QAAQ,QACRC,KAAK,SAACC,UAAmBA,EAAeC,GAAGC,OAAS,IAAGD,GAEpDvB,EADWrB,KAAK8C,gBAAgBX,oDAAoDI,QACjEhB,UAAUC,QAAQ,eAAe,IAAIC,MAAOC,WACrE1B,KAAK+C,aAAanB,mBAAmB,YAAaP,MAGpDQ,OAAA,SAAOV,GACLA,EAAMC,iBAEUD,EAAMY,OAAOC,QAAQ,4BAC7BH,aAlBiBvB,KACpBgC,QAAU,CAAC,SAAU,YAAa,oHCGzCxC,QAAA,sBACEE,KAAKgD,eACLC,SAASzC,iBAAiB,0BAA2B,WACnD0C,EAAKC,kBACJ,CAAEC,MAAM,OAGbJ,aAAA,WAIEjD,EAAEC,KAAKC,SAASwC,QAAQ,CACtBY,wBAAyB,GACzBC,MAAO,aACPC,MAAO,YAIXJ,eAAA,WACEnD,KAAKwD,YACLzD,EAAEC,KAAKC,SAASwC,QAAQ,cAG1Be,UAAA,sBAC0BzD,EAAEC,KAAKC,SAC5BwC,QAAQ,QACRgB,OAAO,SAACd,UAAmBA,EAAeC,GAAGC,OAAS,IAIzCa,QAAQ,SAACf,GACvB5C,EAAE4D,EAAK1D,SACJyC,sBAAsBC,EAAeC,SACrCgB,KAAK,WAAY,kBAlCGtD,GCFvBuD,EAAyB,SAACC,GAC9BA,EAAYC,SAAS,qBAAsBC,GAC3CF,EAAYC,SAAS,+BAAgCE,GACrDH,EAAYC,SAAS,sBAAuBG,GAC5CJ,EAAYC,SAAS,4BAA6BI,GAClDL,EAAYC,SAAS,iBAAkBK"}